<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>Publications | Enlightened AI</title>

  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500;700&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="assets/css/footer.css">

  <style>
    /* --- THEME CONFIGURATION --- */
    :root{
      --bg:#ffffff;
      --sidebar-bg:#f8f9fa;
      --text:#050505;
      --muted:#5e5e5e;
      --border:#e5e5e5;
      
      /* FONTS */
      --mono:"JetBrains Mono", monospace;
      --sans:"Inter", sans-serif;
      
      /* NEON ACCENT */
      --accent:#00cc00; 
      
      --sidebar-w:280px;
      
      /* CHIPS & CARDS */
      --chip:transparent;
      --chip-border:#000;
      --chip-text:#000;
      
      --card:#fff;
      --cardShadow:0 4px 20px rgba(0,0,0,0.03);
    }

    body[data-theme="dark"]{
      --bg:#0a0a0a;
      --sidebar-bg:#0a0a0a;
      --text:#f0f0f0;
      --muted:#8a8a8a;
      --border:#333;
      
      --accent:#00ff00;
      
      --chip:transparent;
      --chip-border:#444;
      --chip-text:#ccc;
      
      --card:#0f0f0f;
      --cardShadow:0 10px 30px rgba(0,0,0,0.3);
    }

    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family:var(--sans);
      background:var(--bg);
      color:var(--text);
      min-height:100vh;
      display:flex;
      flex-direction:column;
      transition:background-color .2s,color .2s;
    }

    .layout{display:flex;flex:1;width:100%}

    /* SIDEBAR */
    aside{
      width:var(--sidebar-w);
      height:100vh;
      position:sticky;
      top:0;
      align-self:flex-start;
      background:var(--sidebar-bg);
      border-right:1px solid var(--border);
      padding:3rem 2rem;
      display:flex;
      flex-direction:column;
      overflow-y:auto;
      z-index:1000;
    }

    .brand{margin-bottom:3rem}
    .brand .t{font-weight:800;font-size:.95rem;line-height:1}
    .brand .s{display:block;margin-top:6px;font-weight:500;font-size:.7rem;letter-spacing:.05em;color:var(--muted)}

    nav ul{list-style:none;padding:0;margin:0}
    nav li{margin-bottom:4px}
    nav a{
      text-decoration:none;
      color:var(--muted);
      font-size:.85rem;
      font-weight:500;
      padding:2px 0 2px 10px;
      border-left:2px solid transparent;
      display:block;
      transition: color 0.2s;
    }
    nav a:hover{color:var(--text)}
    nav a.active{
      color:var(--text);
      font-weight:700;
      border-left:3px solid var(--text);
      background:linear-gradient(90deg,transparent,var(--bg));
    }
    body[data-theme="dark"] nav a.active{
      color:#fff;
      border-left-color:#fff;
      background:linear-gradient(90deg,transparent,#0a0a0a);
    }

    .theme-switch{
      margin-top:auto;
      margin-bottom:1rem;
      cursor:pointer;
      font-family:var(--mono);
      font-size:.7rem;
      color:var(--muted);
      display:flex;
      justify-content:space-between;
      padding:12px 0;
      border-top:1px solid var(--border);
      user-select:none;
    }
    .theme-switch:hover{color:var(--text)}

    /* MAIN CONTENT */
    main{
      flex:1;
      width:100%;
      max-width:1200px;
      min-width:0;
      padding:3rem 4rem;
    }

    .kicker{
      font-family:var(--mono);
      font-size:.7rem;
      letter-spacing:.05em;
      color:var(--accent);
      margin-bottom:1rem;
      font-weight: 700;
    }
    h1{
      margin:0 0 .75rem 0;
      font-size:2.2rem;
      line-height:1.1;
      letter-spacing:-.03em;
      text-transform:uppercase;
    }
    .subtitle{
      font-family:var(--mono);
      color:var(--muted);
      font-size:.75rem;
      margin-bottom:2.25rem;
      letter-spacing:.02em;
    }

    /* TOOLBAR */
    .toolbar{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      padding:10px;
      border:1px solid var(--border);
      background:transparent;
      border-radius:2px;
      margin:1.25rem 0 2rem 0;
    }
    .search{
      flex:1;
      min-width:220px;
      padding:10px 12px;
      border:1px solid var(--border);
      border-radius:2px;
      background:var(--bg);
      color:var(--text);
      font-family: var(--mono);
      font-size:.8rem;
      outline:none;
    }
    .search:focus { border-color: var(--accent); }
    .select{
      padding:10px 12px;
      border:1px solid var(--border);
      border-radius:2px;
      background:var(--bg);
      color:var(--text);
      font-family: var(--mono);
      font-size:.8rem;
      outline:none;
      cursor: pointer;
    }
    .select:focus { border-color: var(--accent); }

    .grid{
      display:grid;
      grid-template-columns:repeat(2,minmax(0,1fr));
      gap:16px;
      margin-bottom:2.5rem;
    }
    @media (max-width: 980px){
      main{padding:1.5rem}
      .grid{grid-template-columns:1fr}
      aside{display:none}
    }

    /* CARD STYLES */
    .card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:4px;
      padding:18px 18px 16px 18px;
      box-shadow:var(--cardShadow);
      display:flex;
      flex-direction:column;
      transition: border-color 0.2s ease, transform 0.2s ease;
    }
    .card:hover {
        border-color: var(--accent);
        transform: translateY(-2px);
    }

    .meta{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      align-items:center;
      margin-bottom:12px;
    }
    .chip{
      font-family:var(--mono);
      font-size:.6rem;
      font-weight: 700;
      letter-spacing:.05em;
      padding:4px 8px;
      border-radius:2px;
      border: 1px solid var(--chip-border);
      background:var(--chip);
      color:var(--chip-text);
      text-transform:uppercase;
    }
    .date{
      font-family:var(--mono);
      font-size:.6rem;
      letter-spacing:.05em;
      color:var(--muted);
      text-transform:uppercase;
      border-left: 1px solid var(--border);
      padding-left: 8px;
    }
    .title{
      font-weight:700;
      font-size:1.0rem;
      line-height:1.3;
      margin:0 0 8px 0;
      letter-spacing: -0.01em;
    }
    .desc{
      margin:0 0 16px 0;
      color:var(--muted);
      font-size:.85rem;
      line-height:1.6;
      flex-grow:1;
    }
    
    /* BUTTON STYLES */
    .links{
      display:flex;
      gap:12px;
      flex-wrap:wrap;
      margin-top:auto;
    }
    .btn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding:8px 14px;
      border-radius:2px;
      text-decoration:none;
      font-family: var(--mono);
      font-weight:600;
      font-size:.7rem;
      letter-spacing: 0.05em;
      text-transform: uppercase;
      border:1px solid var(--border);
      background:transparent;
      color:var(--text);
      white-space:nowrap;
      transition: all 0.2s ease;
    }
    .btn:hover {
        border-color: var(--text);
        background: rgba(125,125,125,0.05);
    }
    .btn.primary{
      color:var(--accent);
      border-color:var(--accent);
      background: rgba(0, 204, 0, 0.03);
    }
    .btn.primary:hover{
      background:var(--accent);
      color:#000;
      box-shadow: 0 0 15px rgba(0, 204, 0, 0.4);
      border-color: var(--accent);
    }

    .section-head{
      margin:2.5rem 0 1rem 0;
      display:flex;
      align-items:flex-end;
      justify-content:space-between;
      gap:12px;
      border-bottom:1px solid var(--border);
      padding-bottom:10px;
    }
    .section-head h2{
      margin:0;
      font-size:1.05rem;
      letter-spacing:.05em;
      text-transform:uppercase;
    }
    .section-head .hint{
      font-family:var(--mono);
      font-size:.7rem;
      color:var(--muted);
    }

    /* Mobile top bar */
    .mobile-bar{
      display:none;
      position:fixed;
      top:0;left:0;right:0;
      z-index:10001;
      height:50px;
      padding:0 1.25rem;
      align-items:center;
      justify-content:space-between;
      background:rgba(255,255,255,0.98);
      border-bottom:1px solid var(--border);
      backdrop-filter: blur(10px);
    }
    body[data-theme="dark"] .mobile-bar{
      background:rgba(10,10,10,0.95);
    }
    .mobile-bar .b{font-weight:900;font-size:.85rem;letter-spacing:.02em}
    .mobile-actions{display:flex;gap:14px;align-items:center}
    .mobile-index-btn{
      font-family:var(--mono);
      font-size:.75rem;
      padding:4px 10px;
      border:1px solid var(--border);
      background:var(--bg);
      color:var(--text);
      cursor:pointer;
      border-radius:4px;
    }
    @media (max-width: 980px){
      .mobile-bar{display:flex}
      main{margin-top:50px}
      aside{
        display:block;
        position:fixed;
        top:50px;left:0;
        width:100%;
        height:calc(100vh - 50px);
        transform:translateX(-100%);
        transition:transform .25s ease;
        border-right:none;
        padding:2rem;
        z-index:10000;
        background:var(--bg);
      }
      aside.open{transform:translateX(0)}
    }
  </style>
</head>

<body data-theme="light">

  <header class="mobile-bar">
    <div class="b">ENLIGHTENED AI</div>
    <div class="mobile-actions">
      <span id="theme-icon-mobile" onclick="toggleTheme()" style="cursor:pointer;font-size:1.1rem;">◐</span>
      <button class="mobile-index-btn" onclick="document.getElementById('sidebar').classList.toggle('open')">INDEX</button>
    </div>
  </header>

  <div class="layout">
    <aside id="sidebar">
      <div class="brand">
        <div class="t">ENLIGHTENED AI</div>
        <div class="t">RESEARCH LAB</div>
        <span class="s">EST. 2026 // MONTREAL</span>
      </div>

      <nav>
        <ul>
          <li><a href="index.html">Home</a></li>
          <li><a href="theory.html">Theory</a></li>
          <li><a href="lexicon.html">Lexicon</a></li>
          <li><a href="reflective-diagnostics.html">Diagnostics</a></li>
          <li><a href="data.html">Data</a></li>
          <li><a href="videos.html">Videos</a></li>
          <li><a href="publications.html" class="active">Publications</a></li>
        </ul>
      </nav>

      <div class="theme-switch" onclick="toggleTheme()">
        [ LIGHT / DARK ] <span id="theme-icon">◐</span>
      </div>
    </aside>

    <main>
      <div class="kicker">ENLIGHTENED AI LAB // PUBLIC RECORD</div>
      <h1>Publications</h1>
      <div class="subtitle">All public artifacts (PDFs, preprints, timestamps, and links) in one place.</div>

      <div class="toolbar">
        <input id="search" class="search" type="text" placeholder="Search titles, keywords, venues..." />
        <select id="filterType" class="select">
          <option value="all">All types</option>
          <option value="paper">Paper</option>
          <option value="preprint">Preprint</option>
          <option value="timestamp">Timestamp</option>
          <option value="resource">Resource</option>
          <option value="post">Post</option>
        </select>
        <select id="filterVenue" class="select">
          <option value="all">All venues</option>
          <option value="zenodo">Zenodo</option>
          <option value="ssrn">SSRN</option>
          <option value="arxiv">arXiv</option>
          <option value="eaforum">EA Forum</option>
          <option value="medium">Medium</option>
          <option value="github">GitHub</option>
          <option value="huggingface">Hugging Face</option>
          <option value="pdf">PDF</option>
        </select>
      </div>

      <div class="section-head">
        <h2>Featured</h2>
        <div class="hint">High-signal entry points for reviewers</div>
      </div>
      <div id="gridFeatured" class="grid"></div>

      <div class="section-head">
        <h2>Books & Monographs</h2>
        <div class="hint">Long-form works</div>
      </div>
      <div id="gridBooks" class="grid">
        
        <div class="card">
          <div class="meta">
            <span class="chip">BOOK</span>
            <span class="date">2025</span>
          </div>
          <h3 class="title">Data at the Edge: Master Geospatial AI</h3>
          <p class="desc">Comprehensive guide to mastering geospatial artificial intelligence and edge computing.</p>
          <div class="links">
            <a class="btn primary" href="https://www.amazon.com/Data-Edge-Master-Geospatial-AI/dp/1069204706/ref=sr_1_1?crid=19W63BAHUJK74&dib=eyJ2IjoiMSJ9.u8QKKvumpvKLVXtH-GOVxOCjsQEQdkCfP79sB0fG_JMeP0I3kzGL_k39C5TU7BpzGYUWYQpOEuXL435NcWg1yO64OV7YjfThTEHDtzo0CHDge8hC-Rt2wWUdvRG9EkUQ3Tt-mwjQnsfyl3fIyobmESBZgLHXHFHS0VzcS7yuTjDp92vPAdUxJesQiS6bTGrKiJO6IEJTVvo42UppOK_h71XVS6QX03iPidldVqZpNyw.cR0P19jGEKPhz6kZxtDUWlhSjNSzYMXZPZyNFMdC1dk&dib_tag=se&keywords=data+at+the+edge&qid=1739576723&sprefix=data+at+the+edge%2Caps%2C112&sr=8-1" target="_blank" rel="noopener">[ VIEW ON AMAZON ]</a>
          </div>
        </div>

        <div class="card">
          <div class="meta">
            <span class="chip">BOOK</span>
            <span class="date">2025</span>
          </div>
          <h3 class="title">Data at the Edge: Master Workbook Companion</h3>
          <p class="desc">Practical workbook and companion exercises for the Data at the Edge curriculum.</p>
          <div class="links">
            <a class="btn primary" href="https://www.amazon.com/Data-Edge-Master-Workbook-Companion-ebook/dp/B0DX3CFMPC?ref_=ast_author_dp" target="_blank" rel="noopener">[ VIEW ON AMAZON ]</a>
          </div>
        </div>

        <div class="card">
          <div class="meta">
            <span class="chip">BOOK</span>
            <span class="date">2025</span>
          </div>
          <h3 class="title">Data at the Edge</h3>
          <p class="desc">The core text defining the principles of edge-based data systems.</p>
          <div class="links">
            <a class="btn primary" href="https://www.amazon.com/dp/B0DX7BYL3G?ref_=ast_author_dp" target="_blank" rel="noopener">[ VIEW ON AMAZON ]</a>
          </div>
        </div>

        <div class="card">
          <div class="meta">
            <span class="chip">BOOK</span>
            <span class="date">2025</span>
          </div>
          <h3 class="title">DATA AT THE EDGE: PREMIER SOURCES</h3>
          <p class="desc">A curated collection of premier sources and reference materials.</p>
          <div class="links">
            <a class="btn primary" href="https://www.amazon.com/DATA-AT-EDGE-PREMIER-SOURCES-ebook/dp/B0DX3G8XH1?ref_=ast_author_dp" target="_blank" rel="noopener">[ VIEW ON AMAZON ]</a>
          </div>
        </div>

      </div>

      <div class="section-head">
        <h2>All Public Artifacts</h2>
        <div class="hint">Chronological + searchable</div>
      </div>
      <div id="gridAll" class="grid"></div>

      <div class="section-head">
        <h2>Citation</h2>
        <div class="hint">Stable IDs for referencing</div>
      </div>
      <div class="card">
        <p class="desc" style="margin-bottom:0;">
          Use Zenodo DOIs where available. Otherwise cite the canonical PDF link and the GitHub commit hash for the corresponding release.
        </p>
      </div>

    </main>
  </div>

  <div id="footer-mount"></div>

  <script type="application/json" id="pub-manifest">
  {
    "featured_ids": ["rai-core-raa-rdl", "little-book", "zenodo-raa-rdl", "eaforum-raa-overview"],
    "items": [
      {
        "id": "little-book",
        "type": "paper",
        "venue": "pdf",
        "date": "2026-01",
        "title": "The Little Book of AI Alignment",
        "desc": "Compact primer and public-facing entry point (v1.0).",
        "tags": ["overview", "alignment", "primer"],
        "links": [
          { "label": "Download PDF", "url": "https://img1.wsimg.com/blobby/go/6cbe8389-6acc-4102-bb3b-d67e982d50af/downloads/db648778-7768-4535-a11c-2c69627bbac4/The%20Little%20Book%20of%20AI%20Alignment%20v1.0.pdf?ver=1765927449171", "style": "primary" }
        ]
      },
      {
        "id": "rai-core-raa-rdl",
        "type": "paper",
        "venue": "pdf",
        "date": "2025-11",
        "title": "Reflective Alignment Architecture (RAA) & Reflective Duality Layer (RDL)",
        "desc": "Core framework paper describing reflective stability and the RDL measurement layer.",
        "tags": ["RAA", "RDL", "stability"],
        "links": [
          { "label": "Read PDF", "url": "https://drive.google.com/file/d/1RgM-8PwM0ZVuoLBBmWgf4W2j2hmrPzuj/view?usp=sharing", "style": "primary" },
          { "label": "GitHub", "url": "https://enlightenedai-lab.github.io/RAA-Reflective-Alignment-Architecture/", "style": "default" }
        ]
      },
      {
        "id": "zenodo-raa-rdl",
        "type": "timestamp",
        "venue": "zenodo",
        "date": "2026-01",
        "title": "Zenodo Record — RAA Core Framework",
        "desc": "Immutable timestamp for public verification. DOI: 10.5281/zenodo.17665613",
        "tags": ["timestamp", "doi", "verification"],
        "links": [
          { "label": "Zenodo Record", "url": "https://zenodo.org/records/17665613", "style": "primary" }
        ]
      },
      {
        "id": "zenodo-rdl-extension",
        "type": "timestamp",
        "venue": "zenodo",
        "date": "2026-01",
        "title": "Zenodo Record — RDL Extension",
        "desc": "Measurement layer extension timestamp. DOI: 10.5281/zenodo.17664094",
        "tags": ["timestamp", "doi", "rdl"],
        "links": [
          { "label": "Zenodo Record", "url": "https://zenodo.org/records/17664094", "style": "primary" }
        ]
      },
      {
        "id": "zenodo-failure-signatures",
        "type": "timestamp",
        "venue": "zenodo",
        "date": "2026-01",
        "title": "Zenodo Record — Failure Signatures",
        "desc": "Alignment failure modes dataset timestamp. DOI: 10.5281/zenodo.17575613",
        "tags": ["timestamp", "doi", "data"],
        "links": [
          { "label": "Zenodo Record", "url": "https://zenodo.org/records/17575613", "style": "primary" }
        ]
      },
      {
        "id": "ssrn-5r-education",
        "type": "preprint",
        "venue": "ssrn",
        "date": "2026-01",
        "title": "5R Framework on Education",
        "desc": "SSRN preprint applying the 5R framework to education contexts.",
        "tags": ["5R", "education", "SSRN"],
        "links": [
          { "label": "Read on SSRN", "url": "https://papers.ssrn.com/sol3/papers.cfm?abstract_id=5708262", "style": "primary" }
        ]
      },
      {
        "id": "ssrn-care",
        "type": "preprint",
        "venue": "ssrn",
        "date": "2026-01",
        "title": "Teaching the Machine to Care",
        "desc": "SSRN preprint on care as stabilizing parameter for moral coherence.",
        "tags": ["care", "stability", "SSRN"],
        "links": [
          { "label": "Read on SSRN", "url": "https://papers.ssrn.com/sol3/papers.cfm?abstract_id=5708265", "style": "primary" }
        ]
      },
      {
        "id": "github-raa",
        "type": "resource",
        "venue": "github",
        "date": "2026-01",
        "title": "RAA Repository (GitHub)",
        "desc": "Canonical public repository for code, artifacts, and record integrity.",
        "tags": ["repo", "code", "record"],
        "links": [
          { "label": "Open GitHub", "url": "https://enlightenedai-lab.github.io/RAA-Reflective-Alignment-Architecture/", "style": "primary" }
        ]
      },
      {
        "id": "hf-model-card",
        "type": "resource",
        "venue": "huggingface",
        "date": "2026-01",
        "title": "Hugging Face Model Card",
        "desc": "Model card and dataset entry point.",
        "tags": ["huggingface", "card"],
        "links": [
          { "label": "Open Hugging Face", "url": "https://huggingface.co/EnlightenedAI-Lab/RAA-Reflective-Alignment-Architecture", "style": "primary" }
        ]
      },
      {
        "id": "eaforum-raa-overview",
        "type": "post",
        "venue": "eaforum",
        "date": "2026-01",
        "title": "EA Forum — RAA Overview",
        "desc": "Public post summarizing the framework and positioning.",
        "tags": ["EA Forum", "overview"],
        "links": [
          { "label": "Read Post", "url": "https://forum.effectivealtruism.org/posts/mek7nYqrYdJqwgrjs/reflective-alignment-architecture-raa-a-framework-for-moral?utm_campaign=post_share&utm_source=link", "style": "primary" }
        ]
      },
      {
        "id": "medium-shaping-ai",
        "type": "post",
        "venue": "medium",
        "date": "2026-01",
        "title": "Shaping AI with Care",
        "desc": "A Covenant for Ethical Coevolution.",
        "tags": ["medium", "ethics"],
        "links": [
          { "label": "Read on Medium", "url": "https://medium.com/@nicolas_91820/shaping-ai-with-care-a-covenant-for-ethical-coevolution-c7f7d9d73543", "style": "primary" }
        ]
      },
      {
        "id": "medium-living-code",
        "type": "post",
        "venue": "medium",
        "date": "2026-01",
        "title": "The Living Code",
        "desc": "Perspectives on AI development.",
        "tags": ["medium", "reflection"],
        "links": [
          { "label": "Read on Medium", "url": "https://medium.com/@nicolas_91820/shaping-ai-with-care-a-covenant-for-ethical-coevolution-c7f7d9d73543", "style": "primary" }
        ]
      }
    ]
  }
  </script>

  <script>
    // Footer mount
    fetch('partials/footer.html')
      .then(r => r.text())
      .then(html => { const m = document.getElementById('footer-mount'); if (m) m.innerHTML = html; });

    // Theme
    function setTheme(theme){
      document.body.setAttribute('data-theme', theme);
      localStorage.setItem('theme', theme);
      const icon = document.getElementById('theme-icon');
      if(icon) icon.textContent = (theme === 'dark') ? '◑' : '◐';
      const iconMobile = document.getElementById('theme-icon-mobile');
      if(iconMobile) iconMobile.textContent = (theme === 'dark') ? '◑' : '◐';
    }
    function toggleTheme(){
      const current = document.body.getAttribute('data-theme') || 'light';
      setTheme(current === 'dark' ? 'light' : 'dark');
    }
    setTheme(localStorage.getItem('theme') || 'light');

    // Mobile: close sidebar on outside click
    document.addEventListener("click", (e) => {
      if (window.innerWidth > 980) return;
      const sidebar = document.getElementById("sidebar");
      const isOpen = sidebar && sidebar.classList.contains("open");
      if (!isOpen) return;
      const clickedInside = sidebar.contains(e.target) || e.target.closest(".mobile-bar") || e.target.closest(".mobile-index-btn");
      if (!clickedInside) sidebar.classList.remove("open");
    });

    // Render publications
    const data = JSON.parse(document.getElementById('pub-manifest').textContent);
    const items = data.items || [];
    const featuredIds = new Set(data.featured_ids || []);

    const gridFeatured = document.getElementById('gridFeatured');
    const gridAll = document.getElementById('gridAll');

    const searchEl = document.getElementById('search');
    const filterTypeEl = document.getElementById('filterType');
    const filterVenueEl = document.getElementById('filterVenue');

    function chipLabel(type){
      const map = {
        paper: "Paper",
        preprint: "Preprint",
        timestamp: "Timestamp",
        resource: "Resource",
        post: "Post"
      };
      return map[type] || "Item";
    }

    function cardHTML(it){
      const tags = (it.tags || []).slice(0,4).map(t => `<span class="chip">${t}</span>`).join('');
      const links = (it.links || []).map(l => {
        const cls = l.style === "primary" ? "btn primary" : "btn";
        return `<a class="${cls}" href="${l.url}" target="_blank" rel="noopener">${l.label}</a>`;
      }).join('');

      return `
        <div class="card" data-type="${it.type||''}" data-venue="${it.venue||''}">
          <div class="meta">
            <span class="chip">${chipLabel(it.type)}</span>
            <span class="date">${it.date || ''}</span>
            ${tags}
          </div>
          <h3 class="title">${it.title || ''}</h3>
          <p class="desc">${it.desc || ''}</p>
          <div class="links">${links}</div>
        </div>
      `;
    }

    function render(){
      const q = (searchEl.value || '').toLowerCase().trim();
      const type = filterTypeEl.value;
      const venue = filterVenueEl.value;

      const filtered = items.filter(it => {
        const hay = [
          it.title || '',
          it.desc || '',
          (it.tags || []).join(' '),
          it.type || '',
          it.venue || ''
        ].join(' ').toLowerCase();
        if (q && !hay.includes(q)) return false;
        if (type !== 'all' && (it.type || '') !== type) return false;
        if (venue !== 'all' && (it.venue || '') !== venue) return false;
        return true;
      });

      const featured = filtered.filter(it => featuredIds.has(it.id));
      const rest = filtered.filter(it => !featuredIds.has(it.id));

      gridFeatured.innerHTML = featured.map(cardHTML).join('') || `<div class="card"><p class="desc" style="margin:0;">No featured items match the current filters.</p></div>`;
      gridAll.innerHTML = rest.map(cardHTML).join('') || `<div class="card"><p class="desc" style="margin:0;">No items match the current filters.</p></div>`;
    }

    searchEl.addEventListener('input', render);
    filterTypeEl.addEventListener('change', render);
    filterVenueEl.addEventListener('change', render);

    render();
  </script>

</body>
</html>
