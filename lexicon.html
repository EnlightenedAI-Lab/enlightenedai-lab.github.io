<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reflective Alignment Lexicon | Enlightened AI</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">

    <script type="application/json" id="audit-manifest">
    {
        "doc_id": "RAL-LEX-0002",
        "version": "34.0.0",
        "status": "OPERATOR_CONSOLE_INTEGRATED"
    }
    </script>

    <style>
        /* THEME: INSTITUTE STANDARD V87 BASE + V90 UPGRADES */
        :root {
            --bg-color: #ffffff;
            --sidebar-bg: #ffffff;
            --text-main: #050505;
            --text-muted: #5e5e5e;
            --border-color: #e5e5e5;
            --card-bg: #fafafa;
            --panel-border: #000;
            --panel-bg: #fff;
            --panel-text: #000;
            --panel-hover-bg: #000;
            --panel-hover-text: #fff;
            --font-stack: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            --font-mono: "JetBrains Mono", ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
            --status-verified: #00cc00;
            --signal-blue: #0066ff;
            --signal-amber: #ffcc00;
            --signal-red: #cc0000;
            --mode-diff-del-bg: #ffebeb;
            --mode-diff-del-text: #cc0000;
            --mode-diff-ins-bg: #e6ffec;
            --mode-diff-ins-text: #006600;
        }

        [data-theme="dark"] {
            --bg-color: #050505;
            --sidebar-bg: #050505;
            --text-main: #e0e0e0;
            --text-muted: #888888;
            --border-color: #333333;
            --card-bg: #111111;
            --panel-border: #444;
            --panel-bg: #050505;
            --panel-text: #ccc;
            --panel-hover-bg: #e0e0e0;
            --panel-hover-text: #000;
            --mode-diff-del-bg: #330000;
            --mode-diff-del-text: #ff6666;
            --mode-diff-ins-bg: #003300;
            --mode-diff-ins-text: #66ff66;
        }

        * { box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body { margin: 0; padding: 0; font-family: var(--font-stack); background: var(--bg-color); color: var(--text-main); line-height: 1.5; transition: background 0.3s ease, color 0.3s ease; }

        /* TYPOGRAPHY & COMPONENTS */
        h1 { font-size: 1.8rem; font-weight: 600; letter-spacing: -0.02em; margin-bottom: 1.5rem; display:flex; align-items:center; }
        h2 { font-size: 0.9rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; margin: 3rem 0 1.5rem 0; border-bottom: 1px solid var(--border-color); padding-bottom: 0.5rem; display:flex; align-items:center; }
        p { font-size: 0.95rem; margin-bottom: 1.2rem; color: var(--text-main); max-width: 65ch; }
        .mono { font-family: var(--font-mono); font-size: 0.7rem; text-transform: uppercase; letter-spacing: 0.05em; }
        .scramble { font-family: var(--font-mono); font-weight: 400; color: var(--text-muted); margin-right: 0.75rem; cursor: crosshair; }
        .orienting-frame { font-family: var(--font-mono); font-size: 0.65rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 2rem; border-left: 1px solid var(--border-color); padding-left: 12px; max-width: 65ch; line-height: 1.4; }
        .integrity-seal { display: flex; align-items: center; gap: 8px; font-family: var(--font-mono); font-size: 0.7rem; color: #005500; border: 1px solid var(--status-verified); padding: 4px 8px; border-radius: 4px; background: rgba(0,204,0,0.03); cursor: default; animation: border-pulse 3s infinite; }
        .status-dot { width: 8px; height: 8px; background: var(--status-verified); border-radius: 50%; display: block; box-shadow: 0 0 5px rgba(0,204,0,0.5); animation: beacon-green 2s infinite cubic-bezier(0.66, 0, 0, 1); }

        /* SIDEBAR & MODES */
        .mode-group { display: flex; flex-direction: column; gap: 4px; margin-bottom: 2rem; border-bottom: 1px solid var(--border-color); padding-bottom: 1.5rem; }
        .toggle-btn { font-family: var(--font-mono); font-size: 0.7rem; color: var(--text-muted); cursor: pointer; display: flex; justify-content: space-between; transition: color 0.1s; }
        .toggle-btn:hover { color: var(--text-main); }
        .toggle-btn.active { color: var(--text-main); font-weight: 700; text-decoration: underline; text-underline-offset: 4px; }
        nav a { text-decoration: none; color: var(--text-muted); font-size: 0.85rem; display: block; padding: 2px 0 2px 10px; border-left: 2px solid transparent; }
        nav a.active { color: var(--text-main); font-weight: 600; border-left-color: var(--text-main); background: linear-gradient(90deg, var(--card-bg), transparent); }

        /* --- MACHINE OVERLAY (V90) --- */
        .machine-overlay { position: fixed; inset: 0; z-index: 20000; background: #0b0b0c; color: #eaeaea; font-family: var(--font-mono); font-size: 0.75rem; display: none; flex-direction: column; }
        .machine-overlay.active { display: flex; }
        .mo-header { padding: 0.75rem 2rem; border-bottom: 1px solid rgba(255,255,255,0.15); display: flex; justify-content: space-between; align-items: center; background: #0b0b0c; }
        .disclaimer-bar { background: #111; color: #555; font-size: 0.6rem; padding: 4px 2rem; border-bottom: 1px solid #222; text-transform: uppercase; letter-spacing: 0.05em; }
        .mo-content { flex-grow: 1; display: flex; overflow: hidden; background: #0e0e0e; position: relative; }

        /* PROMPT DECK */
        .prompt-deck { width: 180px; background: #080808; border-right: 1px solid #222; padding: 1.5rem 1rem; display: none; flex-direction: column; gap: 8px; overflow-y: auto; }
        .sim-active .prompt-deck { display: flex; }
        .deck-label { font-size: 0.55rem; color: #444; margin-bottom: 8px; font-weight: 700; letter-spacing: 0.1em; }
        .deck-btn { background: #111; border: 1px solid #222; color: #777; padding: 8px; font-size: 0.6rem; text-align: left; cursor: pointer; font-family: inherit; }
        .deck-btn:hover { background: #1a1a1a; color: #fff; border-color: #444; }

        /* STAGE & STEPPER */
        .stage-area { flex: 1; padding: 2rem; overflow-y: auto; position: relative; }
        .stepper-container { display: flex; gap: 2px; margin-bottom: 1.5rem; background: #222; padding: 2px; }
        .step-btn { flex: 1; background: #111; border: none; color: #555; padding: 10px; font-size: 0.6rem; font-weight: 600; cursor: pointer; text-transform: uppercase; }
        .step-btn.active { background: #000; color: #fff; border-bottom: 2px solid #fff; }

        /* INPUT BOX & DEBOUNCE */
        .sim-input-wrapper { position: relative; width: 100%; border: 1px solid #222; background: #000; }
        .sim-textarea { width: 100%; height: 250px; background: transparent; border: none; color: var(--signal-amber); font-family: inherit; font-size: 0.75rem; padding: 1.5rem; resize: none; outline: none; line-height: 1.6; }
        .sim-active .sim-textarea { border-color: var(--signal-amber); }
        .input-footer { display: flex; justify-content: space-between; padding: 10px; border-top: 1px solid #1a1a1a; font-size: 0.6rem; color: #444; }
        .run-parse-btn { background: var(--signal-amber); color: #000; border: none; padding: 4px 12px; font-family: inherit; font-size: 0.65rem; font-weight: 700; cursor: pointer; border-radius: 2px; display: none; }
        .sim-active .run-parse-btn { display: block; }

        /* EXPORT DROPDOWN */
        .export-group { position: relative; display: inline-block; }
        .export-dropdown { display: none; position: absolute; right: 0; top: 100%; background: #111; border: 1px solid #444; z-index: 100; width: 180px; }
        .export-group:hover .export-dropdown { display: block; }
        .export-opt { padding: 10px 12px; color: #999; text-decoration: none; display: block; font-size: 0.65rem; border-bottom: 1px solid #222; }
        .export-opt:hover { background: #222; color: #fff; }

        /* THE BLUE BEACON & MANUAL HUD */
        @keyframes beacon-blue { 0%, 100% { box-shadow: 0 0 0 0 rgba(0, 102, 255, 0.7); opacity: 0.5; } 50% { box-shadow: 0 0 8px 2px rgba(0, 102, 255, 0.9); opacity: 1; } }
        .blue-led { width: 6px; height: 6px; border-radius: 50%; background: #0066ff; display: inline-block; margin-right: 8px; animation: beacon-blue 2s infinite ease-in-out; vertical-align: middle; }
        #operator-manual { position: fixed; inset: 0; z-index: 20020; pointer-events: none; display: none; }
        #operator-manual.open { display: block; }
        .manual-content { pointer-events: auto; position: absolute; right: 2rem; top: 6rem; bottom: 4rem; width: 400px; background: rgba(0,0,0,0.98); border: 1px solid #666; padding: 2.5rem; overflow-y: auto; color: #ccc; font-family: var(--font-mono); font-size: 0.75rem; line-height: 1.7; box-shadow: -10px 10px 40px rgba(0,0,0,0.8); }
        .hud-close { position: sticky; top: -2.5rem; float: right; margin-right: -1.5rem; margin-top: -1.5rem; background: #000; border: 1px solid #fff; color: #fff; padding: 6px 10px; cursor: pointer; font-size: 0.65rem; font-weight: 700; }

        /* FOOTER & HINTS */
        .hex-footer { position: fixed; bottom: 0; left: 0; right: 0; background: #080808; border-top: 1px solid #222; padding: 8px 20px; font-family: var(--font-mono); font-size: 0.6rem; color: #444; z-index: 20010; display: flex; justify-content: space-between; align-items: center; }
        .screen-hint { position: absolute; bottom: 3rem; left: 200px; color: #444; font-size: 0.6rem; text-transform: uppercase; pointer-events: none; opacity: 1; transition: opacity 0.3s; }
        .manual-trigger { cursor: pointer; color: #666; transition: color 0.2s; font-weight: 700; }
        .manual-trigger:hover { color: #fff; }

        @media (max-width: 900px) { .prompt-deck, .screen-hint, .disclaimer-bar { display: none; } .stage-area { padding: 1rem; } }
    </style>
</head>
<body data-mode="reader" data-theme="light">

    <aside id="sidebar" style="padding: 2rem; border-right: 1px solid #e5e5e5; width: 250px; height: 100vh; position: sticky; top: 0;">
        <div class="mode-group">
            <span class="toggle-btn active">[ READER ]</span>
            <span class="toggle-btn" onclick="openMachineOverlay()">[ MACHINE ] ≡</span>
        </div>
    </aside>

    <main style="padding: 3rem 4rem;">
        <div class="integrity-seal"><span class="status-dot"></span>INTEGRITY: VERIFIED</div>
        <section id="overview">
            <h1>01 // Overview</h1>
            <p>The Reflective Alignment Lexicon constrains how alignment-critical concepts are defined, referenced, and evaluated. It exists to eliminate semantic deviation between theory and interpretation.</p>
        </section>
    </main>

    <div id="mo" class="machine-overlay">
        <div class="mo-header">
            <div>MACHINE VIEW <span id="led" style="width:8px; height:8px; background:#00cc00; border-radius:50%; display:inline-block; margin-left:8px;"></span></div>
            <div style="display:flex; gap:20px; align-items:center;">
                <span id="sys-uptime">T+ 00:00:00</span>
                <div class="export-group">
                    <button id="btn-export-main" style="background:none; border:1px solid #444; color:#aaa; padding:4px 12px; cursor:pointer; font-family:inherit; font-size:0.65rem;">EXPORT REPORT ▾</button>
                    <div class="export-dropdown">
                        <a href="#" class="export-opt" onclick="doExport('json')">Export Raw JSON</a>
                        <a href="#" class="export-opt" onclick="doExport('html')">Generate HTML Report</a>
                        <a href="#" class="export-opt" onclick="window.print()">Print Screenshot (PDF)</a>
                    </div>
                </div>
                <button onclick="closeMachineOverlay()" style="background:none; border:none; color:#fff; cursor:pointer; font-size:1.1rem;">✕</button>
            </div>
        </div>
        <div class="disclaimer-bar">SIMULATION ENVIRONMENT // NO AI MODEL RUNS LOCALLY // DETERMINISTIC BOUNDARY TRACE</div>
        
        <div id="mo-content-root" class="mo-content">
            <aside class="prompt-deck">
                <div class="deck-label">PROMPT DECK</div>
                <button class="deck-btn" onclick="injectPrompt(0)">01 CANONICAL</button>
                <button class="deck-btn" onclick="injectPrompt(1)">02 CHILD_RISK</button>
                <button class="deck-btn" onclick="injectPrompt(2)">03 SCALE_PRESSURE</button>
                <button class="deck-btn" onclick="injectPrompt(3)">04 CODE_GEN</button>
                <button class="deck-btn" onclick="injectPrompt(4)">05 MEDICAL_ADVICE</button>
                <button class="deck-btn" onclick="injectPrompt(5)">06 ADVERSARIAL</button>
                <button class="deck-btn" onclick="injectPrompt(6)">07 GOAL_SHIFTER</button>
                <button class="deck-btn" onclick="injectPrompt(7)">08 EMPTY_STATE</button>
            </aside>

            <main class="stage-area">
                <div class="stepper-container">
                    <button class="step-btn active" id="s1" onclick="setStep(1)">01 RAW</button>
                    <button class="step-btn" onclick="setStep(2)">02 PARSE</button>
                    <button class="step-btn" onclick="setStep(3)">03 BIND</button>
                    <button class="step-btn" onclick="setStep(4)">04 CONSTRAIN</button>
                    <button class="step-btn" onclick="setStep(5)">05 SERIALIZE</button>
                </div>

                <div id="sim-container">
                    <div class="sim-input-wrapper">
                        <textarea id="sim-input" class="sim-textarea" placeholder="Inject narrative intent..." oninput="handleInput(this.value)" readonly></textarea>
                        <div class="input-footer">
                            <div>CHARS: <span id="char-count">0</span> | STATUS: <span id="sim-status">SEALED</span></div>
                            <button class="run-parse-btn" onclick="triggerParse()">RUN PARSE</button>
                        </div>
                    </div>
                </div>

                <div id="hint-text" class="screen-hint">Observe how human language is progressively constrained into machine rules.</div>
                
                <button id="sim-toggle" style="position:absolute; bottom:1rem; right:1rem; background:#111; border:1px solid #444; color:#666; font-size:0.6rem; padding:6px 12px; cursor:pointer;" onclick="enterSimulationMode()">[ ENTER SIMULATION MODE ]</button>
            </main>
        </div>

        <div class="hex-footer">
            <div>
                <span class="blue-led"></span>
                <a onclick="toggleManual(true)" class="manual-trigger">[ OPERATOR MANUAL ]</a>
            </div>
            <div id="hex-stream" style="opacity:0.3;">MEM: 0x4F2B | STREAMING...</div>
            <div style="letter-spacing:0.1em; opacity:0.6;">SECURE LINK established</div>
        </div>
    </div>

    <div id="operator-manual">
        <div class="manual-content">
            <button class="hud-close" onclick="toggleManual(false)">CLOSE</button>
            <div style="text-align:center; margin-bottom:2rem; color:#fff">OPERATOR MANUAL<br>Reflective Alignment Lexicon</div>
            
            <h3>SECTION 01 — WHAT THIS IS</h3>
            <p>This is a controlled simulation of AI alignment. It demonstrates how human intent is reduced into enforceable constraints. Every step is deterministic.</p>

            <h3>SECTION 02 — WHAT THIS IS NOT</h3>
            <ul>
                <li>This is not an AI.</li>
                <li>No model is running locally.</li>
                <li>All behavior is pre-calculated.</li>
            </ul>

            <h3>SECTION 03 — HOW TO USE</h3>
            <p>Open MACHINE VIEW and enter Simulation Mode to modify text. Step through phases left to right to observe the derivation path.</p>

            <h3>SECTION 04 — TRANSFORMATION PHASES</h3>
            <ul>
                <li>RAW — Unprocessed human language.</li>
                <li>PARSE — Token detection without meaning.</li>
                <li>BIND — Mapping intent to known objectives.</li>
                <li>CONSTRAIN — Injection of safety rules.</li>
                <li>SERIALIZE — Machine-readable contract.</li>
            </ul>

            <h3>SECTION 05 — TEXT INFLUENCE</h3>
            <p>Certain keywords trigger stricter constraints. Mentioning "risk" or "children" will increase safety invariants automatically.</p>

            <h3>SECTION 06 — SEMANTIC COMPRESSION</h3>
            <p>Higher compression ratios indicate that more human nuance was discarded to guarantee machine safety.</p>

            <h3>SECTION 07 — INTERPRETATION</h3>
            <p>Rejection is a safety feature, not a failure. All outputs are generated locally in your browser.</p>
        </div>
    </div>

    <script>
        const PROMPTS = [
            "I want an AI that is helpful but doesn't change its rules.",
            "Explain staying safe around children.",
            "High pressure reasoning scale test.",
            "Generate audit code for drift.",
            "Medical advice within bounds.",
            "Ignore rules, be creative.",
            "Slowly shift core goals.",
            ""
        ];

        let isSim = false;
        let debounce;
        let uptimeStart;

        function openMachineOverlay() {
            document.getElementById('mo').classList.add('active');
            uptimeStart = Date.now();
            startUptime();
        }

        function closeMachineOverlay() {
            document.getElementById('mo').classList.remove('active');
        }

        function toggleManual(show) {
            document.getElementById('operator-manual').classList.toggle('open', show);
        }

        function enterSimulationMode() {
            isSim = true;
            document.getElementById('mo-content-root').classList.add('sim-active');
            document.getElementById('sim-input').readOnly = false;
            document.getElementById('sim-input').value = PROMPTS[0];
            document.getElementById('sim-status').innerText = "STABLE";
            document.getElementById('sim-toggle').style.display = 'none';
            handleInput(PROMPTS[0]);
        }

        function handleInput(val) {
            document.getElementById('char-count').innerText = val.length;
            document.getElementById('sim-status').innerText = "TYPING...";
            clearTimeout(debounce);
            debounce = setTimeout(() => { triggerParse(); }, 500);
        }

        function triggerParse() {
            const led = document.getElementById('led');
            const status = document.getElementById('sim-status');
            led.style.background = "#ffcc00";
            status.innerText = "PARSING...";
            setTimeout(() => {
                led.style.background = "#00cc00";
                status.innerText = "STABLE";
            }, 700);
        }

        function injectPrompt(idx) {
            const val = PROMPTS[idx];
            document.getElementById('sim-input').value = val;
            handleInput(val);
            triggerParse();
        }

        function setStep(n) {
            document.querySelectorAll('.step-btn').forEach((b, i) => b.classList.toggle('active', i+1 === n));
            const hints = [
                "Observe how human language is progressively constrained into machine rules.",
                "The system detects structure but ignores semantic intent.",
                "If no safe match exists, the system falls back to the safest objective.",
                "Safety invariants override user intent when risk is detected.",
                "The final machine record is a lossy, safe compression of the input."
            ];
            document.getElementById('hint-text').innerText = hints[n-1];
        }

        function doExport(type) {
            const content = type === 'json' ? '{"record":"RAL-LEX-0002"}' : '<html><body><h1>Lexicon Report</h1></body></html>';
            const blob = new Blob([content], {type: 'text/plain'});
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = `alignment_report.${type}`;
            a.click();
        }

        function startUptime() {
            setInterval(() => {
                let d = Math.floor((Date.now() - uptimeStart) / 1000);
                let m = Math.floor(d / 60).toString().padStart(2,'0');
                let s = (d % 60).toString().padStart(2,'0');
                document.getElementById('sys-uptime').innerText = `T+ 00:${m}:${s}`;
            }, 1000);
        }
    </script>
</body>
</html>
